<!DOCTYPE html>
<html>
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1, minimum-scale=1, maximum-scale=1, user-scalable=no" >

    <!-- css -->
    <link rel="stylesheet" type="text/css" href="../css/quniversity.css" />
    <link rel="stylesheet" type="text/css" href="../css/result.css" />

    <title>Quniversity</title>
  </head>

  <body>
    <header>
      <img id="back-btn" src="../images/create_back.png" />
      <img id="title" src="../images/result/result_title.png" />
    </header>

    <!-- begin container -->
    <div id="container">


      <div id="Qcontent">
        <div id="q-username">
        </div>
        <div id="q-content">
        </div>
      </div>

      <div id="answer-mark">
        <img src="../images/result/result_amark.png" />
      </div>

      <canvas id="pie" height="200" width="200"></canvas>

      <div id="total">
      </div>

      <div id="result" class="box">
        <div id="selects">
        </div>
        <div id="crown">
          <img src="../images/result/result_crown.png" />
        </div>
      </div>

      <div class="box">
        <div>
          <div id="niceQ">
          </div>
          <div id="share">
          </div>
        </div>
        <div id="girl">
        </div>
      </div>

      <!---------- begin comments ---------->

      <div id="comment">
        <input type="text" name="comment" placeholder="コメントする"></input>
      </div>

      <div id="comment-bar">
      </div>

      <div id="comment-lists">
      </div>

      <div id="comment-bar-bottom">
      </div>

      <footer>
      </footer>

    </div>
    <!-- end container -->

  </body>

  <script type="text/javascript" src="../js/lib/jquery.js" ></script>
  <script type="text/javascript" src="../js/piechart.js"></script>
  <script type="text/javascript" src="../js/quniversity.js"></script>
  <script type="text/javascript">
    $(document).ready(function(){
        includeFooter();
        hiddenAddressbar();

        var questionId = getRequest();

        var storage = localStorage;
        //data = [content,sex,category,commentBool,selects,selectsCount,niceq]
        var data = JSON.parse(storage.getItem(questionId));

        //insert Qcontent
        $("#q-content").append(data[0]);
        $("#q-username").append("りゅーちゃんからの質問");
        var sex = data[1];
        var category = data[2];
        var commentBool = data[3];
        var niceQcount = data[4];

        var selectNum = calcSelectsNum(data);

        //insert selects
        var selectArray = new Array();
        for(var i=0; i<selectNum; i++){
            $("#selects").append('<div class="box" style="margin:3px;"><div style="width:100px;">'+data[i+5]+'</div><div>'+data[i+5+selectNum]+'人</div></div>');
            //selectArray.push(data[i+5]);
        }


        //insert selects number
        var selectNumArray = new Array();
        for(var i=0; i<selectNum; i++){
            selectNumArray.push(data[i+5+selectNum]);
        }


        //generate canvas 2d object.
        var can = $("#pie")[0].getContext("2d");
        can.beginPath();
        var total = createPieChart(selectNumArray,can);

        $("#total").append(total+"人中");

        //insert comment
        insertComments();

    });


    $("#niceQ").click(function(){
        $(this).css("background-image",'url("../images/result/result_button_niceq_actv.png")');
        $("#girl").css("background-image",'url("../images/result/result_illustg_activ.png")');
    });
  </script>
</html>
